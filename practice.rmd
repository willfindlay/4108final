---
author: |
    | William Findlay
title: |
    | COMP4108 Final Exam Practice
date: \today
#bibliography: untitled.bib
biblio-style: ieee
subparagraph: yes
classoption: 12pt
header-includes:
    - \usepackage{findlayrmd}
    - \usepackage{subcaption}
output:
    pdf_document:
        citation_package: biblatex
        number_sections: true
        fig_crop: true
        fig_caption: true
        keep_tex: false
        pandoc_args: ["--listings"]
---
```{r,include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
options(kableExtra.latex.load_packages = FALSE)
library(kableExtra)
library(lubridate)
```
<!-- Setup -->
\pagestyle{fancy}
\setlength{\headheight}{15pt}
\counterwithin{lstlisting}{section}
\renewcommand{\maketitle}{\oldmaketitle}

<!-- Title page -->
\maketitle
\thispagestyle{empty}

<!-- Table of contents -->
\newpage
\pagenumbering{roman}
\tableofcontents

<!-- List of figs, tables, listings -->
<!--
\newpage
\listoffigures
\newpage
\listoftables
\newpage
\lstlistoflistings
-->

<!-- Setup the rest of the document -->
\newpage
\pagenumbering{arabic}
\setcounter{page}{1}

# Preamble

## Textbook

- [here is a link to "Tools and Jewels"](http://people.scs.carleton.ca/~paulv/toolsjewels.html)

## General

1. Please follow the provided format
1. We should prioritize the mock exam over notes

\part{Mock Exam}

\newcounter{question}
\newcounter{subquestion}
\newcommand{\question}[1]{
    \stepcounter{question}
    \setcounter{subquestion}{0}
    \noindent
    \thequestion.\hspace{.5em}#1
}
\newcommand{\subquestion}[1]{
    \stepcounter{subquestion}
    \noindent
    \hspace{1em}\alph{subquestion})\hspace{.5em} #1
}

\setcounter{section}{0}

# Basic Concepts and Principles

\question{Provide definitions for the following:}
\subquestion{Confidentiality}
\vspace{4em}
\subquestion{Data integrity}
\vspace{4em}
\subquestion{Authentication}
\vspace{4em}
\subquestion{Authorization}
\vspace{4em}
\subquestion{Availability}
\vspace{4em}
\subquestion{Accountability}
\vspace{4em}
\vspace{1em}

\question{Briefly explain how repudiation violates accountability.}
\vspace{4em}

\question{Describe the difference between a {\itshape trusted} and {\itshape trustworthy} actor.}
\vspace{4em}

\question{Compare and contrast {\itshape privacy}, {\itshape protection}, and {\itshape anonymity}.}
\vspace{8em}

\question{Come up with a simple example of a security policy for a house and describe a way it might be violated.}
\vspace{8em}

\question{Label each number in \autoref{threat} using the following terms:}
\subquestion{target asset}
\subquestion{vulnerability}
\subquestion{attacker}
\subquestion{attack vector}
\subquestion{threat agent}

\begin{figure}
\includegraphics[width=.5\textwidth]{./figs/threat-agent-attacker.png}
\caption{}
\label{threat}
\end{figure}
\vspace{1em}

\FloatBarrier

\question{Draw a state machine diagram of a system's transition from a secure state to either a secure state or an insecure state.}
\vspace{10em}

\question{Compare and contrast quantitative and qualitative risk assessment.
Consider the advantages and disadvantages of each, as well as how each might work in theory/practice.}

\begin{table}
\begin{tabular}{|c|c|}
\hline
\textbf{Qualitative} & \textbf{Quantitative}\\
\hline
\hline
\hspace{.4\textwidth} & \hspace{.4\textwidth} \\
& \\
& \\
& \\
& \\
& \\
& \\
& \\
& \\
& \\
& \\
& \\
& \\
& \\
\hline
\end{tabular}
\end{table}

\question{Consider $R = T \times V \times C$.}
\subquestion{What is this equation for?}
\vspace{4em}
\subquestion{Describe each variable in this equation. How does each variable relate to the equation's purpose?}
\vspace{4em}
\subquestion{Which two variables may be combined into $P$? What does the simplified equation look like?
What does $P$ represent?}
\vspace{4em}

\question{Describe two risk assessment challenges.}
\vspace{10em}

\question{Which of the following is not an adversary attribute?}
\subquestion{objectives}
\subquestion{outsider/insider}
\subquestion{methods}
\subquestion{funding level}
\subquestion{capabilities}
\subquestion{attack vector}
\vspace{1em}

\clearpage
\question{What is a categorical schema? How is it different from a capability-level schema?}
\vspace{6em}

\question{Compare and contrast a formal security evaluation with penetration testing.}

\begin{table}
\begin{tabular}{|c|c|}
\hline
\textbf{Formal Security Evaluation} & \textbf{Penetration Testing}\\
\hline
\hline
\hspace{.4\textwidth} & \hspace{.4\textwidth} \\
& \\
& \\
& \\
& \\
& \\
& \\
& \\
& \\
& \\
& \\
& \\
& \\
& \\
\hline
\end{tabular}
\end{table}
\vspace{1em}

\question{What is white-box pen testing? Black-box?}
\vspace{6em}

\question{Consider STRIDE. What does each letter stand for?}
\subquestion{S:}
\subquestion{T:}
\subquestion{R:}
\subquestion{I:}
\subquestion{D:}
\subquestion{E:}
\vspace{1em}

\clearpage
\question{Draw a tree model for compromising the password to a bank account. Include at least three leaf nodes.}
\vspace{14em}

\question{Is it possible to completely test a comprehensive (and practical) set of security mechanisms for a system?
Why or why not?}
\vspace{8em}

\question{Explain the observability (or lack thereof) of security in the context of {\itshape negative goals}.}
\vspace{8em}

\question{Assurance in security is best described as which of the following?}
\subquestion{Simple, effective}
\subquestion{Difficult, partial}
\subquestion{Simple, practical}
\subquestion{Difficult, complete}
\subquestion{None of the above}

\clearpage

# Cryptographic Building Blocks

\question{Suppose Alice encrypts a message to Bob using $E_k(m) = c$. How does Bob decrypt the message?}
\vspace{4em}

\question{What is an exhaustive key search? What does the attacker try to do? Is this the worst case for attacking a cryptosystem?}
\vspace{8em}

\question{Label each of the following attacks as either an action by an {\itshape active} or a {\itshape passive} adversary.
Once you have labeled the attack, describe it.}
\subquestion{Known plaintext attack}
\vspace{4em}
\subquestion{Ciphertext only attack}
\vspace{4em}
\subquestion{Chosen plaintext attack}
\vspace{4em}
\subquestion{Chosen ciphertext attack}
\vspace{4em}

\clearpage
\question{What is the main advantage of a one-time pad? Describe three disadvantages. Why are one-time pads not used?}
\vspace{10em}

\question{What is the current standard for block ciphers?}
\vspace{8em}

\question{Describe a situation in which we would need to use a stream cipher. Why can't you use another type of cipher?}
\vspace{8em}

\question{What is a mode of operation used for?}
\vspace{8em}

\question{What is one major flaw with the ECB mode of operation?}
\vspace{8em}

\clearpage

\question{Draw a picture of the CBC mode of operation.}
\vfill

\question{Draw a picture of the CTR mode of operation.}
\vfill

\clearpage

\question{If Alice wants to send a message to Bob using public-key encryption,
\_\_\_\_\_\_\_\_\_\_ is used to encrypt and \_\_\_\_\_\_\_\_\_\_ is used to decrypt.}
\subquestion{Bob's private key, Alice's public key}
\subquestion{Bob's public key, Alice's private key}
\subquestion{Bob's public key, Bob's private key}
\subquestion{Alice's private key, Alice's public key}
\subquestion{None of the above}

\vspace{1em}

\question{If Alice wants to send a message to Bob using a public-key signature scheme,
\_\_\_\_\_\_\_\_\_\_ is used to sign and \_\_\_\_\_\_\_\_\_\_ is used to verify}
\subquestion{Bob's private key, Alice's public key}
\subquestion{Bob's public key, Alice's private key}
\subquestion{Bob's public key, Bob's private key}
\subquestion{Alice's private key, Alice's public key}
\subquestion{None of the above}

\vspace{1em}

\question{How does hybrid encryption work? What role does symmetric key encryption play? Public-key encryption?}
\vspace{10em}

\question{What three security properties do digital signature schemes provide? To whom to they provide them?}
\vspace{8em}

\clearpage

\question{What two security properties do MACs provide? To whom do they provide them?}
\vspace{8em}

\question{What security property does a cryptographic hash provide? To whom does it provide the property?}
\vspace{8em}

\question{Describe each of the following properties of cryptographic hash functions.}
\subquestion{Preimage resistance}
\vspace{4em}
\subquestion{Second preimage resistance}
\vspace{4em}
\subquestion{Collision resistance}
\vspace{4em}

\question{How are hash functions used for password storage and verification? What property or properties of hash functions make
this a desirable use case?}
\vspace{10em}

\clearpage

\question{Is it generally better to MAC then encrypt, or encrypt then MAC?}
\vspace{4em}

# User Authentication

\question{Describe each of the following ways to defeat password authentication.
For each technique you describe, provide one way to prevent it.}
\subquestion{Online guessing}
\vspace{6em}
\subquestion{Offline guessing}
\vspace{6em}
\subquestion{Defeating password recovery}
\vspace{6em}
\subquestion{Bypassing authentication interface}
\vspace{6em}
\subquestion{Password capture}
\vspace{6em}

\clearpage

\question{Describe 3 advantages of passwords. Describe 3 disadvantages.}
\vspace{10em}

\question{What is a password hash salt? A pepper?}
\vspace{10em}

\question{What is iterated hashing? What is it used for? How does it compare with other techniques to solve the same problem?}
\vspace{20em}

\clearpage

\question{Explain the following:}
\subquestion{Dictionary attack}
\vspace{4em}
\subquestion{Mangling rules}
\vspace{4em}

\question{Describe the trade-off that occurs when using system-assigned passwords. How do these passwords help to mitigate dictionary attacks}
\vspace{10em}

\question{Suppose you had a password scheme that has an alphabet of size $b$ and allows passwords as long as $n$ characters.
How long would it take to brute force passwords in this scheme in:}
\subquestion{The worst case?}
\vspace{5em}
\subquestion{The average case?}
\vspace{5em}

\question{Consider $q = GT/R$. What does this equation describe? What is each variable for?}
\vspace{8em}

\clearpage

\question{Draw password distributions in \autoref{password-space} according to the captions.}

\begin{figure*}
\begin{subfigure}[t]{0.4\textwidth}
\includegraphics{./figs/password-space.png}
\caption{Password distribution we want.}
\end{subfigure}
~
~
~
\begin{subfigure}[t]{0.4\textwidth}
\includegraphics{./figs/password-space.png}
\caption{Password distribution we see in practice.}
\end{subfigure}
\caption{}
\label{password-space}
\end{figure*}

\vspace{1em}

\question{Discuss rate limiting and password change policies with respect to online guessing attacks.
How does $q = GT/R$ factor into making decisions regarding these policies?}
\vfill

\clearpage

\question{Discuss the drawbacks of complex site login password composition policies. Suggest at least three better alternatives.}
\vspace{20em}
\question{What is a passkey? Why are complex passwords preferred for passkeys? How can passphrases help with usability issues
associated with these complex passwords?}
\vfill

\clearpage

\question{How can password blacklisting be used to reduce the effectiveness of dictionary attacks?}
\vspace{10em}

\question{Why are secret questions generally a terrible method for password recovery?
Why do you think they are so widely used despite their drawbacks?}
\vspace{20em}

\question{What is a one-time password? How can a Lamport Hash Chain be used to extend a single key word
to $t$ one-time passwords?}
\vspace{20em}

\clearpage

\question{Explain how Lamport Hash Chains are vulnerable to a man-in-the-middle attack using small $n = t - i$.}
\vspace{20em}

\question{Describe the following categories of authentication and provide an example for each:}
\subquestion{What you have}
\vspace{5em}
\subquestion{What you are}
\vspace{5em}
\subquestion{What you know}
\vspace{5em}
\subquestion{Where you are}
\vspace{5em}

\clearpage

\question{What is multi-factor authentication?}
\vspace{5em}

\question{Describe some advantages and disadvantages of hardware token authentication.}
\vspace{10em}

\question{Give an example of each of the following modalities with respect to biometric authentication:}
\subquestion{Physical}
\vspace{5em}
\subquestion{Behavioral}
\vspace{5em}
\subquestion{Mixed}
\vspace{5em}

\question{Biometrics are secrets.}
\subquestion{True}
\subquestion{False}

\vspace{1em}

\question{Biometric authentication to a remote site via a phone sends your biometric signature for authentication.}
\subquestion{True}
\subquestion{False}

\vspace{1em}

\clearpage

\question{Is it better to have a higher false acceptance rate or false rejection rate?
Make an argument using the definitions of each.}

\vfill

\question{Draw a bimodal distribution with a higher false acceptance rate than false rejection rate.
Clearly define where your $t$ is located with a straight line.}

\vfill

\clearpage

\question{What is $EER$? How is it used in practice?}
\vspace{5em}

\question{What is the difference between identification and authentication?}
\vspace{5em}

\question{Describe at least three criteria used for the evaluation of biometric authentication.}
\vspace{15em}

\question{Explain failure to enroll and failure to capture in the context of biometric authentication.}
\vspace{10em}

# Authentication Protocols and Key Establishment

# Operating Systems Security and Access Control

# Software Security -- Privilege and Escalation

# Malicious Software

# Public Key Certificate Management and Use Cases

\question{What is a distinguished name? What does it do?}
\vspace{5em}

\question{What is a public key certificate? What does it do? What trusted third party does it rely on?}
\vspace{5em}

\question{Which of the following is generally preferred?}
\subquestion{An entity sends a public key in their certification request}
\subquestion{An entity sends a certification request and the CA generates their key pair}
\subquestion{These are equivalent}
\vspace{1em}

\question{What does a PKI do? Give one example of a PKI and how it is used in practice.}
\vspace{10em}

\question{What is X509 used for? What does it specify?}
\vspace{5em}

\question{What is a certificate chain? Why are they necessary?}
\vspace{5em}

\question{What part of a certificate chain requires implicit trust? What part(s) is expected to sign its own certificate?}
\vspace{5em}

\question{What happens if part of a certificate chain is broken?}
\vspace{5em}

\question{What is an out-of-band channel? What do we use them for when checking certificate integrity?}
\vspace{5em}

\question{Why is allowing users to manually trust certificates not always the best idea? Why do browsers do it anyway?}
\vspace{5em}

\question{Consider Trust-On-First-Use under the following circumstances. What is the result in each case?}
\subquestion{An attacker has replaced a self-signed certificate with their own}
\vspace{5em}
\subquestion{The self-signed certificate is legitimate}
\vspace{5em}

\question{Suppose you tried to browse a site with an X509v3 certificate that had 4 extension fields, one marked
critical, the other three non-critical. What would happen in the following scenarios (assuming the rest of the
certificate is fine)?}
\subquestion{You have an older browser that cannot handle the critical extensions}
\vspace{5em}
\subquestion{You have an older browser that cannot handle one of the non-critical extensions}
\vspace{5em}
\subquestion{You have an older browser that cannot handle any of the non-critical extensions}
\vspace{5em}

\question{Draw a picture of a cross certificate between two hierarchies. Describe one use case for cross certificates.}
\vspace{10em}

\question{Consider the difference between {\itshape trust} and {\itshape trustworthiness}. What does a certificate
trust model provide with respect to these terms?}
\vspace{5em}

\question{Label (a), (b), and (c) in \autoref{ca-hierarchies} with the correct label from the following choices:}

\subquestion{Ring mesh}
\subquestion{Bridge CA model}
\subquestion{Separate domains}
\vspace{1em}

\question{Circle the trust anchor(s) for the right-most leaves in each diagram in \autoref{ca-hierarchies}.}
\vspace{1em}

\begin{figure}
\includegraphics[width=0.5\textwidth]{./figs/ca-hierarchies.png}
\caption{}
\label{ca-hierarchies}
\end{figure}
\vspace{3em}

\question{What are the leaf nodes in the browser trust model for CAs?}
\vspace{5em}

\question{For each label in \autoref{bt-question}, decide which of the following terms suits it best.}
\subquestion{Browser trust model}
\subquestion{Strict CA hierarchy model}
\subquestion{Enterprise PKI model}
\vspace{1em}

\question{Circle the trust anchor(s) for the right-most leaves in each diagram in \autoref{bt-question}.}
\vspace{1em}

\begin{figure}
\includegraphics[width=0.7\textwidth]{./figs/bt-question.png}
\caption{}
\label{bt-question}
\end{figure}
\FloatBarrier
\vspace{3em}

\question{What is Web of Trust? Give an example of where we might use it.}
\vspace{5em}

\question{Order the following validation types from least to most thorough:}
\subquestion{DV}
\subquestion{OV}
\subquestion{EV}
\subquestion{IV}
\vspace{1em}

\question{What is a certificate substitution attack? What does this mean for the browser trust model?}
\vspace{5em}

\question{How easy is it for a user to alter the browser trust model? Answer in terms of both accepting and revoking trust.
Is this a good thing or a bad thing?}
\vspace{15em}

\question{What do PEM, PGP, and S/MIME all have in common?}
\vspace{5em}

\question{Where is the security header added in secure email?}
\vspace{5em}

\question{Briefly explain how secure email uses public-key and/or symmetric-key cryptography.}
\vspace{10em}

\question{What is a public key server? What is a certificate directory? What problem do these hope to solve?}
\vspace{15em}

# Web and Browser Security

# Firewalls and Tunnels

# Intrusion Detection and Network-Based Attacks

\clearpage

\part{Notes}


# Basic Concepts and Principles

# Cryptographic Building Blocks

# User Authentication

# Authentication Protocols and Key Establishment

# Operating Systems Security and Access Control

# Software Security -- Privilege and Escalation

## Race Conditions

- TOCTOU
    - time of check to time of use
    - setuid has owner's privileges, but we need to make sure real user can access the file
    - `access` system call traditionally used
    - but an attacker can attempt to change the file between checking access and opening it for writing
    - this allows us to access another file that we shouldn't
- how to stop this?
    - atomic privilege checks would be nice
        - not portable
    - drop privileges and then fork before opening the file, make descriptor available to parent before exiting
        - also not portable
    - use system calls that deal directly with file descriptors
        - also not portable
    - no perfect solution, application dependent
- other notes
    - niceness can tip the balance in the attacker's favor
    - make checking process much higher niceness (slower) -> larger window to win the race

## Integer-Based Vulnerabilities and C Issues

- problems:
    - signedness
    - overflow
    - underflow

### Problems with C

- favor efficiency/direct access over security
    - it lets us make mistakes like the ones above without warning
- undefined behavior -> machine-dependent results
    - signed integers have undefined behavior, unsigned integers use modular wrapping
- pointer arithmetic
- accessing memory using overflow/underflow values
- using overflow/underflow values for branching conditions
- pointer arithmetic changes based on size of type
- types can have different sizes based on architecture

#### Why We Can't Just Fix This

- some developers rely on the behavior we described above (intentional overflows)
    - introducing runtime errors breaks backwards compatibility
- warning about possible errors is not necessarily possible
- safe integer libraries are a good option, but how do we enforce adoption?

## Stack-Based Buffer Overflows

- too many bytes written to stack may overflow into adjacent memory
- natural vs intentional
    - natural yields unexpected outcomes
    - intentional results in security issues

### Memory Layout

- text and global data segments are lowest, initialized at start
- heap is low, grows up
- stack is high, grows down

### How it Works

- on function call, new args are pushed onto stack
- current instruction pointer is pushed as return address
- now we push local vars onto stack and execute the function
- overflowing a local var overwrites higher memory
    - if we overwrite return address, we can point it elsewhere, including into our overwritten memory

## Heap-Based Buffer Overflows

- dynamic allocation is less predictable, varies between systems
- attacker has to experiment to find a vulnerable variable
    - there needs to be a useful higher memory address that is exploitable
- this is also only useful if memory corruption does not crash the program

### Heap Spraying

- inject code many, many times into various locations in the heap
- then use an independent exploit to trigger code execution
- you only need to get it right once

## Three Main Steps for Buffer Overflows

1. Code injection
    - inject code into an area of memory
1. Corruption of control flow
    - change control flow to go to that code
1. Seizure of control
    - run that code

## Buffer Overflow Exploit Defenses

- make head and stack non-executable
- stack canaries
    - key words that detect code injection
    - if the key word is overwritten, raise an error
- run-time bounds checking
- ASLR, random heap allocators
    - randomize memory layout
    - disrupts attacks that rely on known memory locations
- type-safe languages
- safe C libraries
- static analysis tools
    - analyze code and flag potential problems

## Privilege Escalation

- move from fixed functionality to a command shell
- escape a sandbox
- gain root privileges
- move from root privileges to kernel privileges (e.g., install a rootkit kernel module)






# Malicious Software

## Viruses vs Worms

- both propagate, carry a payload
    - mechanisms differ
- virus
    - requires user interaction to propagate, run
    - payload triggers on a condition
    - infect host files / software
        - even documents -> macro viruses
- worm
    - propagate automatically, over networks
    - don't need to be run by a user
    - exploit running software

#### Virus Infection Strategies

1. Write beginning of file
1. Write end of file
1. Overwrite entire file
1. Overwrite a specific portion of file

- appending or prepending does not damage functionality, but is noticeable due to file size change
- overwriting harms functionality of program
    - make sure it's not critical to running the system

#### Virus Detection

- impossible to write a program to detect all possible viruses
- instead, we play a cat and mouse game with attackers
    - increasing complexity
- detection: data signature-based detection, integrity checking, behavioral signatures

#### Virus Anti-Detection

- encrypt and store internal decryptor key
- polymorphic virus that changes decryptor portions across infections
- place decryption key in an external file
- metamorphic virus -> mutates both body and mutation engine

#### Auto Rooters

- scan for vulnerable targets, exploit opportunistically
- only need one vulnerability to spawn a root shell and/or install a rootkit

#### Fast Worm Spreading

- generate hit lits by scanning for vulnerable hosts
- permute compromised addresses to find new targets strategically
- internet-scale hit lists
    - scan servers

## Trojan Horses

- disguises malicious functionality as useful functionality
- sometimes combines malicious functionality with useful functionality
- often social engineering
    - disguised updates for legitimate programs
- may remain undetected for some time

## Backdoors

- bypass normal entrypoints (and access control)
- remote-access Trojan (spawn a remote root shell)
- malicious remote desktop/shell tools
- rootkits

## Key Loggers

- can be implemented with rootkits hooking system calls
- log user actions / keystrokes to steal information
- more severe -> surveillance software

## Rootkits

- installed after an attack to allow attacker to keep coming back
- goals
    - conceals its presence
    - controls or manipulates applications/OS
    - facilitates long-term additional malicious activity
- rootkits often provide backdoors
- can be implemented in userspace or kernelspace
    - kernelspace is more dangerous (supervisor mode, control whole OS, easier to conceal itself)

#### Rootkit Methods

- hooking system calls (patch dispatch table)
- inline hooking
    - detour and trampoline functions
- kernel object modification (to hide activity)
    - either directly change the kernel object
    - or modify the return values of key system calls via postprocessing
- installation strategies
    - exploit buffer overflows in kernel
    - alter shared library or application in userspace
    - install loadable kernel module (after gaining root privilege via some other means)

## Drive-By Downloads

- exploit browser vulnerability + code injection to legitimate site (or by phishing with a malicious site)
- results in downloading a malicious executable silently
- defenses?
    - downloader graphs
    - comparing download patterns

## Droppers

- malicious software whose job it is to download and install other malicious software
- can arrive by means of a worm, virus, trojan, or drive-by-download

## Ransomware

- malware designed to extort users into paying
- often controlled via a botnet
- anonymous payment methods like bitcoin are exacerbating their effectiveness
- examples
    - encryption file lockers (use encryption to lock users out of their files and require payment to unlock the key)
    - other methods of file locking (access control, threaten to erase data, syskeying in Windows)

## Botnets

- a coordinated network of enslaved machines
    - exploited initially via shell code or other means
- attack establishes control over many remote systems
    - the controlling machine is called the botnet header
- uses these systems to commit cyber crimes
    - provide an economy of scale to attackers
    - DDOS attacks, spread ransomware, malicious crypto mining, etc.

## Zero-Day Exploits

- target a vulnerability in a program that was not known previously
- only useful before the vulnerability is patched
- users not patching their software can make this especially problematic

## Logic Bomb

- malicious payload executed when a condition is met
- this is used in viruses and worms for example




# Public Key Certificate Management and Use Cases

## PKIs

- public key infrastructure
- basic function is to provide a means of verifying a public key belongs to an entity
- CAs, sPKI, WoT

## Certificates

- fields
    - subject (DN)
    - issuer (DN)
    - version information
    - validity period
    - extension fields
        - critical and non-critical (if you can't handle critical, reject)
- X509 tells you what fields
- DN
    - distinguished name (uniquely IDs an actor)
    - Country
    - Organization
    - Organizational Unit
    - Common name
- subject alternate name(s)
    - other names that a subject can go by
- certificate can be
    - issued
    - revoked
    - expired
    - valid
    - invalid

## Certificate Authorities

- issue certificates
- root CA requires implicit trust
    - intermediate CAs to distribute the task of issuing/verifying
- each CA has its own certificate
    - root CA (trust anchor) signs its own

#### Certificate Chains

- intermediate CAs
- root of the chain is the root CA
    - root CA is generally trusted via information obtained from an out of band channel
    - e.g., browsers have a list of root CAs they trust implicitly
        - cross certificate pairs can handle the test

#### Cross Certificate Pair

- two CAs sign each other's certificates
- if you trust one, you can trust the other one
- builds connected trust on the internet

## Certificate Trust Models

#### Single-CA

- each tree has one CA

- Separate Domains
    - one CA for each set of leaf nodes
    - everything is kept completely separate otherwise
    - no cross certificate pairs
- Ring Mesh
    - like separate domains except all top-level CAs are linked with cross certificate pairs
- Bridge CA Model
    - cross certificate pairs with a central hub

#### Strict Hierarchy

- root CA with intermediate CAs forming a connected tree
- cross certification is possible within the tree but not between separate trees

#### Ring-Mesh of Tree Roots

- like strict hierarchy except now tree roots are free to cross-certify

#### Browser Trust Model

- list of trust anchors for each end point
- no cross certificates in browser trust model
- each tree is a hierarchy
- leaf nodes correspond to servers

#### Enterprise PKI

- intermediate CAs at lower levels cross certify between departments
- allows fine-grained control of trust

#### Web of Trust

- each entity signs their own keys and then entities sign each other's keys
- you pick a subset to trust, and then trust keys trusted by those you already trust
- used in PGP, secure email for example

## Grades of Certificate

- IV
    - user decides to trust a self-signed certificate
- DV
     - validates a domain only
- OV
    - validates domain and organization
- EV
    - extensive validation process

## Secure Email / Public Key Distribution

- technologies
    - PGP -> web of trust
    - PEM -> one-root PKI
    - S/MIME -> secure MIME, used with centralized certificate management
- relies on either key distribution or certificate directories

#### Security Header

- goes into the content rather than the original header
    - for backwards compatibility
- this header is digitally signed and often contains an encrypted symmetric key
    - this symmetric key is encrypted with public key crypto
    - allows us to read encrypted mail offline
- steps
    1. verify the signature
    1. decrypt the symmetric key
    1. use the symmetric key to decrypt the body to plaintext

#### Key Distribution

- we ask a trusted third party to generate a public key and owner ID for us

#### Certificate Directory

- we ask a trusted third party to distribute certificates to use as needed




# Web and Browser Security

**N.B., I am omitting all the webdev review stuff at the beginning of this chapter.
If somebody would like to make a PR to add it, that would surely be appreciated.**


## TLS and HTTPS

#### TLS Layers

- two layers
1. handshake layer
    - (unencrypted) key exchange
    - (encrypted) server parameters
    - (encrypted) integrity and authentication
1. record layer
    - protects all data using negotiated parameters

#### TLS Key Exchange

- three options
1. DHE (ephemeral diffie-hellman)
     - either finite fields (integers mod p)
     - or elliptic curves
1. PSK (pre-shared key)
     - either pre-shared via out-of-band channel or from a previous TLS session
1. PSK combined with DHE

#### TLS Server Authentication

- two (or technically four) options
1. either PSK session key
1. or digital signature (based on certificate)
    - digital signature RSA
    - or ECDSA
    - or EdDSA
- client and server send MAC codes to signal they are done

#### TLS Encryption and Integrity

- usually encryption is done in two ways
1. either via ChaCha20 (stream cipher)
1. or AES (block cipher) using an acceptable mode
- hash algorithms provide data integrity

## DOM Objects

## Same-Origin Policy

## HTTP Cookies

## Authentication Cookies

## CSRF

## XSS

#### XSS-Stored

#### XSS-Reflected

## SQL Injection

## Sanitization



# Firewalls and Tunnels

## Packet Filter Firewalls

## Proxy Firewalls and Firewall Architectures

## SSH

## VPNs and Encrypted Tunnels






# Intrusion Detection and Network-Based Attacks

## Response Types: Detection vs Prevention

#### Alarms (Detection Only)

#### Intrusion Prevention Systems

## Architecture: Host-Based vs Network-Based

#### Host Based

#### Network Based

## Event Outcomes

#### False Positives

#### False Negatives

#### True Positives

#### True Negatives

#### Base Rates and FPR/FNR Trade-Off

## Methodologies: Anomalies vs Signatures vs Specifications

#### Blacklisting vs Whitelisting

#### Anomaly Detection

#### Signatures

#### Specifications

## Sniffers, Reconnaissance Scanners, Vulnerability Scanners

## DoS Attacks

## Address Resolution Attacks






<!-- References -->
\clearpage
